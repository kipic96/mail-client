-- Generated by Oracle SQL Developer Data Modeler 17.2.0.188.1059
--   at:        2017-08-14 17:48:18 CEST
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



CREATE TABLE city (
    id     INTEGER
        CONSTRAINT nnc_city_city_id NOT NULL,
    name   NVARCHAR2(50)
        CONSTRAINT nnc_city_name NOT NULL
);

COMMENT ON TABLE city IS
    'The dictionary of cities';

ALTER TABLE city ADD CONSTRAINT city_pkey PRIMARY KEY ( id );

CREATE TABLE day_type (
    id     INTEGER NOT NULL,
    name   NVARCHAR2(50) NOT NULL
);

COMMENT ON TABLE day_type IS
    'The dictionarity of day types';

ALTER TABLE day_type ADD CONSTRAINT day_type_fkey PRIMARY KEY ( id );

CREATE TABLE departure (
    id               INTEGER NOT NULL,
    departure_time   DATE NOT NULL,
    day_type_id      INTEGER NOT NULL
);

COMMENT ON TABLE departure IS
    'The time and day type of departure';

ALTER TABLE departure ADD CONSTRAINT departure_pkey PRIMARY KEY ( id );

CREATE TABLE line (
    id             INTEGER NOT NULL,
    "number"       INTEGER NOT NULL,
    line_type_id   INTEGER NOT NULL
);

COMMENT ON TABLE line IS
    'The specification of line ';

ALTER TABLE line ADD CONSTRAINT line_pkey PRIMARY KEY ( id );

CREATE TABLE line_departure (
    id             INTEGER NOT NULL,
    departure_id   INTEGER NOT NULL
);

COMMENT ON TABLE line_departure IS
    'The line that departures at given time and day type';

ALTER TABLE line_departure ADD CONSTRAINT line_departure_pkey PRIMARY KEY ( id,departure_id );

CREATE TABLE line_routes (
    id                           INTEGER NOT NULL,
    two_stations_connection_id   INTEGER NOT NULL
);

COMMENT ON TABLE line_routes IS
    'Routes of the lines';

ALTER TABLE line_routes ADD CONSTRAINT line_routes_pkey PRIMARY KEY ( id,two_stations_connection_id );

CREATE TABLE line_type (
    id     INTEGER NOT NULL,
    name   NVARCHAR2(50) NOT NULL
);

COMMENT ON TABLE line_type IS
    'The type of vehicles on given line';

ALTER TABLE line_type ADD CONSTRAINT line_type_pkey PRIMARY KEY ( id );

CREATE TABLE station (
    id                INTEGER
        CONSTRAINT nnc_station_idstation NOT NULL,
    slot_id           INTEGER
        CONSTRAINT nnc_station_idslot NOT NULL,
    city_id           INTEGER
        CONSTRAINT nnc_station_idcity NOT NULL,
    station_name_id   INTEGER
        CONSTRAINT nnc_station_idbusstopname NOT NULL
);

COMMENT ON TABLE station IS
    'Station and its name,city';

ALTER TABLE station ADD CONSTRAINT bus_stop_pkey PRIMARY KEY ( id );

CREATE TABLE station_name (
    id     INTEGER NOT NULL,
    name   NVARCHAR2(50)
);

COMMENT ON TABLE station_name IS
    'The dictionary of cities';

ALTER TABLE station_name ADD CONSTRAINT bus_stop_name_pkey PRIMARY KEY ( id );

CREATE TABLE two_stations_connection (
    id                  INTEGER NOT NULL,
    station_id_first    INTEGER NOT NULL,
    station_id_second   INTEGER NOT NULL,
    travel_distance     INTEGER NOT NULL,
    travel_time         INTEGER NOT NULL
);

COMMENT ON TABLE two_stations_connection IS
    'The times and distances beetween two stations';

ALTER TABLE two_stations_connection ADD CONSTRAINT two_stations_connection_pkey PRIMARY KEY ( id );

ALTER TABLE station
    ADD CONSTRAINT city_id_fkey FOREIGN KEY ( city_id )
        REFERENCES city ( id );

ALTER TABLE departure
    ADD CONSTRAINT day_type_id_fkey FOREIGN KEY ( day_type_id )
        REFERENCES day_type ( id );

ALTER TABLE line_departure
    ADD CONSTRAINT departure_id_fkey FOREIGN KEY ( departure_id )
        REFERENCES departure ( id )
            ON DELETE CASCADE;

ALTER TABLE line_routes
    ADD CONSTRAINT line_id_fkey FOREIGN KEY ( id )
        REFERENCES line ( id )
            ON DELETE CASCADE;

ALTER TABLE line_departure
    ADD CONSTRAINT line_id_fkeyv2 FOREIGN KEY ( id )
        REFERENCES line ( id )
            ON DELETE CASCADE;

ALTER TABLE line
    ADD CONSTRAINT line_type_id_fkey FOREIGN KEY ( line_type_id )
        REFERENCES line_type ( id );

ALTER TABLE two_stations_connection
    ADD CONSTRAINT station_id_fkey1 FOREIGN KEY ( station_id_first )
        REFERENCES station ( id )
            ON DELETE CASCADE;

ALTER TABLE two_stations_connection
    ADD CONSTRAINT station_id_fkey2 FOREIGN KEY ( station_id_second )
        REFERENCES station ( id )
            ON DELETE CASCADE;

ALTER TABLE station
    ADD CONSTRAINT station_name_id_fkey FOREIGN KEY ( station_name_id )
        REFERENCES station_name ( id );

ALTER TABLE line_routes
    ADD CONSTRAINT two_stations_id_fkey FOREIGN KEY ( two_stations_connection_id )
        REFERENCES two_stations_connection ( id );



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            10
-- CREATE INDEX                             0
-- ALTER TABLE                             20
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
